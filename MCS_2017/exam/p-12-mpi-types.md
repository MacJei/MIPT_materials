## Типы данных в MPI, создание собственных типов данных. Упаковка и распаковка данных в массивы. Перенос данных между реализациями MPI.

Рассмотрим, какие типы данных предоставляет MPI из-под коробки. Для начала перечислим стандартные типы данных, которыми оперирует MPI:
* `MPI_CHAR` — `char`;
* `MPI_SHORT` — `short int`;
* `MPI_INT` — `int`;
* `MPI_LONG` — `long int`;
* `MPI_LONG_LONG` — `long long`;
* `MPI_FLOAT` — `float`;
* `MPI_DOUBLE` — `double`;
* `MPI_LONG_DOUBLE` — `long double`.

Заметим, что для целочисленных типов есть беззнаковые варианты. Однако MPI предоставляет функционал и для расширения пользовательских типов данных и создания своих. Объявления сущности типа данных содержится в переменной, имеющей тип `MPI_Datatype`. Перед использованием нового типа данных необходима его регистрация, которая осуществляется вызовом функции `MPI_Type_Commit(MPI_Datatype* datatype)`. После использования тип можно очистить посредством вызова `MPI_Type_free(MPI_Datatype* datatype)`.

Перейдем к рассмотрению способов создания новых типов данных.

* `int MPI_Type_contiguous(int count, MPI_Datatype oldtype, MPI_Datatype *newtype)` — создание непрерывной последовательности переменных одного типа. Подобным способом, к примеру, удобно передавать координаты точек на плоскости или в про-
странстве, цветовую палитру типа RGB и т.п.

* `int MPI_Type_vector(int count, int blocklen, int stride, MPI_Data_type oldtype, MPI_Datatype *newtype)` — векторный способ. Тип состоит из последовательности блоков размера `blocklength`, расстояние между началами блоков равняется `stride`. Примером применения векторного способа является передача столбцов матрицы, реализованной в виде двумерного массива. При этом можно задать `blocklen`, равный `1`, а `stride`, равный числу элементов в строке.


* `int MPI_Type_indexed(int count, const int *array_of_blocklengths, const int *array_of_displacements, MPI_Datatype oldtype, MPI_Datatype *newtype)` — индексный способ. Является расширением векторного способа (размер блоков может быть различным, расстояния между блоками могут быть различными). Отличия по синтаксису таковы: `array_of_blocklenghts` задает длины блоков, а `array_of_displacements` задает сдвиги начала блоков относительно начала. Применяется для задания подструктур некоторых матриц: к примеру, можно определить диагональ матрицы или верхнетреугольную подматрицу.

* `int MPI_Type_struct(int count, const int *array_of_blocklengths, const MPI_Aint *array_of_displacements, const MPI_Datatype *array_of_types, MPI_Datatype *newtype)` — создание аналога структур — пожалуй, наиболее общий способ задания собственных типов. Тем самым можно создать массив, описывающий типы данных, затем их соединить в некоторые блоки, количество которых выражается в переменной `count`. Для задания сдвигов внутри элементов каждого блока используется функция `int MPI_Type_extent(MPI_Datatype datatype, MPI_Aint *extent)`, которая позволяет узнать размер, который имеет тип для передачи данных (важно заметить, что данная величина может отличаться  (и скорее всего отличается) от фактического размера типа).
